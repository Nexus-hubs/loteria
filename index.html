<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Loter√≠a Memory GPT - Enhanced</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <style>
    :root {
      --bg: #050509;
      --bg-alt: #0b0b13;
      --card-back: radial-gradient(circle at 20% 0%, #151623, #050509);
      --card-front: #111119;
      --accent: #18c0a7;
      --accent-soft: rgba(24, 192, 167, 0.3);
      --accent-strong: rgba(24, 192, 167, 0.7);
      --border-subtle: rgba(255, 255, 255, 0.06);
      --text-main: #f9fafb;
      --text-soft: #a0a3b1;
      --danger: #ff4b81;
      --radius-lg: 18px;
      --radius-md: 14px;
      --radius-pill: 999px;
      --shadow-soft: 0 18px 40px rgba(0, 0, 0, 0.8);
      --shadow-card: 0 10px 30px rgba(0, 0, 0, 0.7);
      --timing-fast: 150ms;
      --timing-med: 220ms;
      --timing-slow: 320ms;
    }

    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      user-select: none;
    }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      overflow: hidden;
      background: radial-gradient(circle at 10% 0%, #101320, #050509 55%, #020208);
      color: var(--text-main);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      touch-action: manipulation;
    }

    body {
      display: flex;
      align-items: stretch;
      justify-content: center;
      padding: 16px;
    }

    .app {
      max-width: 1200px;
      width: 100%;
      border-radius: 24px;
      background: radial-gradient(circle at top, #12131c, #050509 60%);
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow:
        0 0 0 1px rgba(255, 255, 255, 0.02),
        0 40px 120px rgba(0, 0, 0, 0.9);
      padding: 20px 22px 18px;
      display: flex;
      flex-direction: column;
      gap: 16px;
      position: relative;
      overflow: hidden;
      height: 100%;
    }

    .app::before {
      content: "";
      position: absolute;
      inset: -80%;
      background:
        radial-gradient(circle at 10% 0%, rgba(24, 192, 167, 0.06), transparent 40%),
        radial-gradient(circle at 90% 0%, rgba(27, 106, 214, 0.09), transparent 40%);
      opacity: 0.9;
      pointer-events: none;
      z-index: -1;
    }

    /* Header */

    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 12px;
      min-width: 0;
      flex: 1;
    }

    .logo-orb {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background:
        conic-gradient(from 200deg, #18c0a7, #1b6ad6, #18c0a7);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow:
        0 0 0 2px rgba(0, 0, 0, 0.9),
        0 0 30px rgba(24, 192, 167, 0.7);
      position: relative;
      overflow: hidden;
      flex-shrink: 0;
    }

    .logo-orb::after {
      content: "";
      position: absolute;
      inset: 18%;
      border-radius: inherit;
      background: radial-gradient(circle, #050509 10%, transparent 70%);
      opacity: 0.7;
    }

    .logo-orb-icon {
      position: relative;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      border: 1.4px solid rgba(5, 5, 9, 0.9);
      box-shadow: 0 0 12px rgba(5, 5, 9, 0.9);
    }

    .title-group {
      display: flex;
      flex-direction: column;
      gap: 2px;
      min-width: 0;
      flex: 1;
    }

    .title-main {
      font-size: 16px;
      font-weight: 600;
      letter-spacing: 0.02em;
      display: flex;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
    }

    .title-pill {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: var(--radius-pill);
      border: 1px solid rgba(24, 192, 167, 0.7);
      background: radial-gradient(circle at top, rgba(24, 192, 167, 0.3), transparent 70%);
      color: var(--text-main);
      text-transform: uppercase;
      white-space: nowrap;
    }

    .title-sub {
      font-size: 12px;
      color: var(--text-soft);
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 1;
      -webkit-box-orient: vertical;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .status-dot {
      width: 9px;
      height: 9px;
      border-radius: 999px;
      background: radial-gradient(circle, #19e0b3, #18c0a7);
      box-shadow: 0 0 14px rgba(24, 192, 167, 0.9);
    }

    .status-text {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--text-soft);
    }

    .header-chip {
      font-size: 11px;
      padding: 4px 10px;
      border-radius: var(--radius-pill);
      border: 1px solid rgba(255, 255, 255, 0.12);
      background: linear-gradient(to right, #10111a, rgba(16, 17, 26, 0.6));
      color: var(--text-soft);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .chip-dot {
      width: 6px;
      height: 6px;
      border-radius: 99px;
      background: var(--accent);
    }

    /* Volume Controls */
    .volume-controls {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 6px 10px;
      border-radius: var(--radius-pill);
      background: rgba(8, 9, 16, 0.9);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    .volume-label {
      font-size: 10px;
      color: var(--text-soft);
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }

    .volume-slider {
      width: 60px;
      height: 4px;
      -webkit-appearance: none;
      appearance: none;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 2px;
      outline: none;
    }

    .volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--accent);
      cursor: pointer;
      box-shadow: 0 0 8px rgba(24, 192, 167, 0.6);
    }

    .volume-slider::-moz-range-thumb {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--accent);
      cursor: pointer;
      border: none;
      box-shadow: 0 0 8px rgba(24, 192, 167, 0.6);
    }

    /* Layout */

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 0.9fr);
      gap: 16px;
      flex: 1;
      min-height: 0;
      overflow: hidden;
    }

    @media (max-width: 900px) {
      .layout {
        grid-template-columns: minmax(0, 1fr);
        grid-template-rows: 1fr auto;
      }
      .chat-panel {
        max-height: 250px;
      }
    }

    @media (max-width: 640px) {
      body {
        padding: 8px;
      }
      .app {
        padding: 12px;
        border-radius: 16px;
      }
      .header {
        gap: 8px;
      }
      .title-main {
        font-size: 14px;
      }
      .title-sub {
        font-size: 11px;
      }
      .status-text {
        display: none;
      }
      .header-chip {
        padding: 3px 8px;
        font-size: 10px;
      }
    }

    /* Game panel */

    .game-panel {
      border-radius: var(--radius-lg);
      background: radial-gradient(circle at top left, #161825, #050509 48%);
      border: 1px solid var(--border-subtle);
      box-shadow: var(--shadow-soft);
      padding: 14px 14px 16px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      position: relative;
      overflow: hidden;
      min-height: 0;
    }

    .game-panel::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 0% 0%, rgba(24, 192, 167, 0.12), transparent 40%);
      opacity: 0.7;
      pointer-events: none;
    }

    .game-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      position: relative;
      z-index: 1;
      flex-wrap: wrap;
    }

    .game-title {
      font-size: 14px;
      font-weight: 500;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: var(--text-soft);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .game-title::before {
      content: "";
      width: 14px;
      height: 14px;
      border-radius: 999px;
      border: 1px solid rgba(24, 192, 167, 0.7);
      box-shadow: 0 0 14px rgba(24, 192, 167, 0.7);
      background: radial-gradient(circle, #18c0a7, #1b6ad6);
    }

    .game-controls {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .pill {
      padding: 4px 9px;
      border-radius: var(--radius-pill);
      border: 1px solid rgba(255, 255, 255, 0.1);
      background: rgba(12, 13, 21, 0.9);
      color: var(--text-soft);
      font-size: 11px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
    }

    .pill strong {
      font-weight: 600;
      color: var(--text-main);
    }

    .btn-ghost {
      border-radius: var(--radius-pill);
      border: 1px solid rgba(255, 255, 255, 0.12);
      background: radial-gradient(circle at top, rgba(32, 36, 54, 0.9), rgba(12, 13, 21, 0.95));
      color: var(--text-main);
      font-size: 11px;
      letter-spacing: 0.09em;
      text-transform: uppercase;
      padding: 7px 13px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      position: relative;
      overflow: hidden;
      transition:
        background var(--timing-med) ease,
        border-color var(--timing-med) ease,
        transform var(--timing-fast) ease,
        box-shadow var(--timing-fast) ease;
      touch-action: manipulation;
    }

    .btn-ghost::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(120deg, rgba(24, 192, 167, 0.2), transparent 40%, rgba(18, 160, 220, 0.23));
      opacity: 0;
      transition: opacity var(--timing-slow) ease;
    }

    .btn-ghost span {
      position: relative;
    }

    .btn-ghost:hover,
    .btn-ghost:active {
      border-color: rgba(24, 192, 167, 0.8);
      box-shadow: 0 0 0 1px rgba(24, 192, 167, 0.3);
    }

    .btn-ghost:hover::before,
    .btn-ghost:active::before {
      opacity: 1;
    }

    .btn-ghost:active {
      transform: translateY(1px) scale(0.98);
    }

    .btn-ghost-icon {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: radial-gradient(circle, #18c0a7, #1b6ad6);
      box-shadow: 0 0 10px rgba(24, 192, 167, 0.9);
      position: relative;
    }

    .stats-row {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 8px;
      position: relative;
      z-index: 1;
    }

    .stat-card {
      border-radius: 12px;
      background: rgba(8, 9, 16, 0.92);
      border: 1px solid rgba(255, 255, 255, 0.04);
      padding: 8px 9px;
      display: flex;
      flex-direction: column;
      gap: 3px;
      font-size: 11px;
      color: var(--text-soft);
    }

    .stat-label {
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }

    .stat-value {
      font-size: 15px;
      font-weight: 600;
      color: var(--text-main);
    }

    .stat-sub {
      font-size: 10px;
      color: var(--accent);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    @media (max-width: 640px) {
      .stat-sub {
        font-size: 9px;
      }
    }

    /* Board */

    .board-wrapper {
      position: relative;
      flex: 1;
      min-height: 0;
      margin-top: 6px;
    }

    .board {
      position: absolute;
      inset: 0;
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 10px;
      padding: 4px;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }

    @media (max-width: 900px) {
      .board {
        gap: 8px;
      }
    }

    @media (max-width: 640px) {
      .board {
        grid-template-columns: repeat(4, minmax(0, 1fr));
        gap: 6px;
        padding: 2px;
      }
    }

    @media (max-width: 480px) {
      .board {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .card {
      position: relative;
      border-radius: 16px;
      perspective: 900px;
      transform-origin: center;
      transition: transform var(--timing-fast) ease;
      aspect-ratio: 0.7;
      min-height: 80px;
    }

    .card button {
      all: unset;
      cursor: pointer;
      width: 100%;
      height: 100%;
      display: block;
      touch-action: manipulation;
    }

    .card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      border-radius: inherit;
      transform-style: preserve-3d;
      transition: transform 260ms ease-out, box-shadow 220ms ease;
      box-shadow: var(--shadow-card);
    }

    .card-face {
      position: absolute;
      inset: 0;
      border-radius: inherit;
      backface-visibility: hidden;
      border: 1px solid rgba(255, 255, 255, 0.09);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    /* Minimalistic back */

    .card-back {
      background: var(--card-back);
      color: var(--text-main);
      padding: 8px 8px 9px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: space-between;
      gap: 6px;
    }

    .card-back-top {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      font-size: 9px;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: rgba(249, 250, 251, 0.35);
    }

    .card-back-center-min {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .card-back-symbol {
      width: 26px;
      height: 26px;
      border-radius: 999px;
      border: 1px solid rgba(249, 250, 251, 0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      color: #ffffff;
      box-shadow:
        0 0 0 1px rgba(0, 0, 0, 0.9),
        0 0 18px rgba(255, 255, 255, 0.5);
      background: radial-gradient(circle at 30% 0%, #ffffff, #e0e4f2 50%, #050509 95%);
    }

    .card-back-label {
      font-size: 9px;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: rgba(249, 250, 251, 0.45);
    }

    @media (max-width: 640px) {
      .card-back-top,
      .card-back-label {
        font-size: 8px;
      }
      .card-back-symbol {
        width: 22px;
        height: 22px;
        font-size: 12px;
      }
    }

    /* Front */

    .card-front {
      background: radial-gradient(circle at top, rgba(255, 255, 255, 0.02), transparent 45%), var(--card-front);
      color: var(--text-main);
      transform: rotateY(180deg);
      padding: 6px 7px 7px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--text-soft);
    }

    .card-number {
      font-weight: 600;
      color: var(--accent);
    }

    .card-main {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 5px;
    }

    .card-icon {
      font-size: 32px;
      line-height: 1;
      color: #ffffff;
      text-shadow:
        0 0 18px rgba(255, 255, 255, 0.6),
        0 0 40px rgba(24, 192, 167, 0.6);
    }

    .card-name {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      text-align: center;
      color: var(--text-main);
      margin-top: 2px;
    }

    .card-caption {
      font-size: 10px;
      color: var(--text-soft);
      text-align: center;
    }

    @media (max-width: 640px) {
      .card-header {
        font-size: 8px;
      }
      .card-icon {
        font-size: 24px;
      }
      .card-name {
        font-size: 10px;
      }
      .card-caption {
        font-size: 8px;
        display: none;
      }
    }

    .card-footer {
      font-size: 9px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      color: var(--text-soft);
    }

    .card-tag {
      padding: 2px 7px;
      border-radius: var(--radius-pill);
      border: 1px solid rgba(255, 255, 255, 0.14);
      background: rgba(5, 5, 9, 0.9);
      text-transform: uppercase;
      letter-spacing: 0.11em;
    }

    .card-hint {
      font-size: 9px;
      color: var(--accent-soft);
    }

    @media (max-width: 640px) {
      .card-footer {
        font-size: 8px;
      }
      .card-hint {
        display: none;
      }
    }

    .card.flipped .card-inner {
      transform: rotateY(180deg);
      box-shadow: 0 0 0 1px rgba(24, 192, 167, 0.7), 0 10px 30px rgba(24, 192, 167, 0.4);
    }

    .card.matched .card-inner {
      box-shadow: 0 0 0 1px rgba(24, 192, 167, 0.6), 0 0 40px rgba(24, 192, 167, 0.8);
    }

    .card.matched .card-front {
      border-color: rgba(24, 192, 167, 0.9);
    }

    .card.disabled {
      pointer-events: none;
      opacity: 0.4;
    }

    /* Chat panel */

    .chat-panel {
      border-radius: var(--radius-lg);
      background: radial-gradient(circle at 0% 0%, #171826, #050509 48%);
      border: 1px solid var(--border-subtle);
      padding: 14px 14px 16px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      box-shadow: var(--shadow-soft);
      position: relative;
      overflow: hidden;
      min-height: 0;
    }

    .chat-panel::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 100% 0%, rgba(27, 106, 214, 0.18), transparent 45%);
      opacity: 0.9;
      pointer-events: none;
    }

    .chat-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      position: relative;
      z-index: 1;
      flex-wrap: wrap;
    }

    .chat-title {
      font-size: 13px;
      font-weight: 500;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .chat-title span:first-child {
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: var(--text-soft);
    }

    .chat-title span:last-child {
      font-size: 11px;
      color: var(--text-soft);
    }

    .chat-badges {
      display: flex;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
    }

    .chat-badge {
      font-size: 10px;
      padding: 3px 8px;
      border-radius: var(--radius-pill);
      border: 1px solid rgba(255, 255, 255, 0.1);
      background: rgba(6, 7, 12, 0.9);
      color: var(--text-soft);
      display: inline-flex;
      align-items: center;
      gap: 5px;
      white-space: nowrap;
    }

    .chat-badge-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: radial-gradient(circle, #18c0a7, #1b6ad6);
      box-shadow: 0 0 10px rgba(24, 192, 167, 0.9);
    }

    .chat-body {
      position: relative;
      flex: 1;
      min-height: 0;
      margin-top: 4px;
    }

    .chat-scroll {
      position: absolute;
      inset: 0;
      overflow: auto;
      padding: 6px 4px 4px 0;
      scrollbar-width: thin;
      scrollbar-color: rgba(120, 124, 144, 0.6) transparent;
      -webkit-overflow-scrolling: touch;
    }

    .chat-scroll::-webkit-scrollbar {
      width: 6px;
    }

    .chat-scroll::-webkit-scrollbar-thumb {
      background: rgba(120, 124, 144, 0.6);
      border-radius: 999px;
    }

    .chat-messages {
      display: flex;
      flex-direction: column;
      gap: 8px;
      padding-right: 4px;
    }

    .msg-row {
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }

    .msg-row.assistant {
      justify-content: flex-start;
    }

    .msg-row.user {
      justify-content: flex-end;
    }

    .msg-avatar {
      width: 22px;
      height: 22px;
      border-radius: 999px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      flex-shrink: 0;
    }

    .msg-avatar.assistant {
      background: radial-gradient(circle, #18c0a7, #1b6ad6);
      color: #050509;
      box-shadow: 0 0 16px rgba(24, 192, 167, 0.9);
      border: 1px solid rgba(5, 5, 9, 0.8);
    }

    .msg-avatar.user {
      background: radial-gradient(circle at 0% 0%, #27293a, #151623);
      color: var(--text-main);
      border: 1px solid rgba(255, 255, 255, 0.12);
    }

    .msg-bubble {
      max-width: 100%;
      border-radius: 14px;
      padding: 7px 9px;
      font-size: 12px;
      line-height: 1.5;
      position: relative;
    }

    .msg-bubble.assistant {
      background: rgba(8, 9, 16, 0.96);
      border: 1px solid rgba(255, 255, 255, 0.06);
      color: var(--text-main);
    }

    .msg-bubble.user {
      background: linear-gradient(135deg, rgba(24, 192, 167, 0.2), rgba(27, 106, 214, 0.25));
      border: 1px solid rgba(24, 192, 167, 0.7);
      color: var(--text-main);
    }

    .msg-meta {
      font-size: 10px;
      color: var(--text-soft);
      margin-top: 3px;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .typing-indicator {
      display: inline-flex;
      align-items: center;
      gap: 3px;
      padding: 2px 0;
    }

    .typing-dot {
      width: 4px;
      height: 4px;
      border-radius: 50%;
      background: rgba(160, 163, 177, 0.85);
      animation: typing 1s infinite ease-in-out;
    }

    .typing-dot:nth-child(2) {
      animation-delay: 0.2s;
    }

    .typing-dot:nth-child(3) {
      animation-delay: 0.4s;
    }

    @keyframes typing {
      0%, 80%, 100% {
        transform: translateY(0);
        opacity: 0.4;
      }
      40% {
        transform: translateY(-2px);
        opacity: 1;
      }
    }

    .chat-footer {
      position: relative;
      z-index: 1;
      margin-top: 4px;
      border-radius: 11px;
      border: 1px solid rgba(255, 255, 255, 0.06);
      background: linear-gradient(120deg, rgba(12, 13, 21, 0.95), rgba(6, 7, 12, 0.96));
      padding: 7px 9px;
      font-size: 10px;
      color: var(--text-soft);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      flex-wrap: wrap;
    }

    .chat-footer span {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .chat-footer-badge {
      padding: 3px 8px;
      border-radius: var(--radius-pill);
      border: 1px solid rgba(255, 255, 255, 0.12);
      background: rgba(10, 11, 18, 0.98);
      font-size: 10px;
      color: var(--text-soft);
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }

    .chat-footer-circle {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      border: 2px solid rgba(24, 192, 167, 0.8);
      box-shadow: 0 0 12px rgba(24, 192, 167, 0.9);
    }

    /* Start overlay */

    .start-overlay {
      position: absolute;
      inset: 0;
      border-radius: inherit;
      background: radial-gradient(circle at 20% 0%, rgba(24, 192, 167, 0.16), transparent 55%),
        radial-gradient(circle at 80% 0%, rgba(27, 106, 214, 0.22), transparent 50%),
        linear-gradient(180deg, rgba(5, 5, 9, 0.96), rgba(5, 5, 9, 0.98));
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      padding: 20px;
    }

    .start-card {
      max-width: 420px;
      width: 100%;
      padding: 18px 18px 16px;
      border-radius: 22px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      background: radial-gradient(circle at top, rgba(18, 160, 220, 0.2), transparent 55%),
        rgba(7, 8, 15, 0.98);
      box-shadow:
        0 0 0 1px rgba(255, 255, 255, 0.03),
        0 30px 80px rgba(0, 0, 0, 1);
      display: flex;
      flex-direction: column;
      gap: 10px;
      text-align: left;
    }

    .start-card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
    }

    .start-title {
      font-size: 16px;
      font-weight: 600;
      letter-spacing: 0.03em;
      display: flex;
      flex-direction: column;
      gap: 3px;
    }

    .start-title span:first-child {
      text-transform: uppercase;
      font-size: 11px;
      color: var(--text-soft);
      letter-spacing: 0.14em;
    }

    .start-title span:last-child {
      font-size: 18px;
      letter-spacing: 0.04em;
    }

    .start-pill {
      font-size: 11px;
      padding: 4px 10px;
      border-radius: var(--radius-pill);
      border: 1px solid rgba(24, 192, 167, 0.8);
      background: rgba(5, 5, 9, 0.95);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
    }

    .start-pill-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: radial-gradient(circle, #18c0a7, #1b6ad6);
      box-shadow: 0 0 14px rgba(24, 192, 167, 0.9);
    }

    .start-body {
      font-size: 13px;
      color: var(--text-soft);
      line-height: 1.6;
    }

    .start-body strong {
      color: var(--text-main);
    }

    .start-footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 4px;
      gap: 8px;
      flex-wrap: wrap;
    }

    .btn-primary {
      border-radius: var(--radius-pill);
      border: 1px solid rgba(24, 192, 167, 0.9);
      background: radial-gradient(circle at 0% 0%, #18c0a7, #1b6ad6);
      color: #050509;
      font-size: 12px;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      padding: 8px 15px;
      cursor: pointer;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 0 0 1px rgba(5, 5, 9, 0.9), 0 14px 35px rgba(24, 192, 167, 0.8);
      transition:
        transform var(--timing-fast) ease,
        box-shadow var(--timing-fast) ease,
        filter var(--timing-fast) ease;
      touch-action: manipulation;
    }

    .btn-primary:hover,
    .btn-primary:active {
      filter: brightness(1.05);
      box-shadow: 0 0 0 1px rgba(5, 5, 9, 0.9), 0 18px 40px rgba(24, 192, 167, 0.95);
      transform: translateY(-1px);
    }

    .btn-primary:active {
      transform: translateY(0);
      box-shadow: 0 0 0 1px rgba(5, 5, 9, 0.9), 0 8px 22px rgba(24, 192, 167, 0.7);
    }

    .start-note {
      font-size: 11px;
      color: var(--text-soft);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .start-note-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      border: 2px solid rgba(255, 255, 255, 0.55);
    }

    @media (max-width: 640px) {
      .start-card {
        padding: 14px;
      }
      .start-title span:last-child {
        font-size: 16px;
      }
      .start-body {
        font-size: 12px;
      }
      .start-footer {
        flex-direction: column;
        align-items: stretch;
      }
      .btn-primary {
        width: 100%;
        justify-content: center;
      }
    }

    .hidden {
      display: none;
    }

    .fade-out {
      animation: fadeOut 380ms ease forwards;
    }

    @keyframes fadeOut {
      to {
        opacity: 0;
        transform: scale(0.98);
        pointer-events: none;
      }
    }

    .pulse {
      animation: pulse 1.6s infinite ease-in-out;
    }

    @keyframes pulse {
      0%, 100% {
        transform: scale(1);
        opacity: 1;
      }
      50% {
        transform: scale(1.03);
        opacity: 0.9;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="header">
      <div class="header-left">
        <div class="logo-orb">
          <div class="logo-orb-icon"></div>
        </div>
        <div class="title-group">
          <div class="title-main">
            Loter√≠a Memory GPT
            <span class="title-pill">Enhanced</span>
          </div>
          <div class="title-sub">
            Memory pairs inspired by Mexican Loter√≠a - Enhanced mobile & desktop experience.
          </div>
        </div>
      </div>
      <div class="header-right">
        <div class="volume-controls">
          <span class="volume-label">üéµ</span>
          <input type="range" min="0" max="100" value="40" class="volume-slider" id="musicVolume" />
        </div>
        <div class="volume-controls">
          <span class="volume-label">üîä</span>
          <input type="range" min="0" max="100" value="50" class="volume-slider" id="sfxVolume" />
        </div>
        <div class="status-dot"></div>
        <div class="status-text">Online</div>
      </div>
    </header>

    <main class="layout">
      <!-- Game panel -->
      <section class="game-panel">
        <div class="game-header">
          <div class="game-title">Memory board</div>
          <div class="game-controls">
            <div class="pill">
              <strong>Normal</strong>
              <span>4x4</span>
            </div>
            <button class="btn-ghost" id="resetButton">
              <div class="btn-ghost-icon"></div>
              <span>Reset</span>
            </button>
          </div>
        </div>

        <div class="stats-row">
          <div class="stat-card">
            <div class="stat-label">Moves</div>
            <div class="stat-value" id="movesCounter">0</div>
            <div class="stat-sub">Track your progress</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Pairs</div>
            <div class="stat-value" id="pairsCounter">0 / 8</div>
            <div class="stat-sub">Find all twins</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Time</div>
            <div class="stat-value" id="timeCounter">00:00</div>
            <div class="stat-sub">Take your time</div>
          </div>
        </div>

        <div class="board-wrapper">
          <div class="board" id="board"></div>
        </div>
      </section>

      <!-- Chat panel -->
      <section class="chat-panel">
        <div class="chat-header">
          <div class="chat-title">
            <span>Loter√≠a GPT</span>
            <span>Your guide through the game.</span>
          </div>
          <div class="chat-badges">
            <div class="chat-badge">
              <div class="chat-badge-dot"></div>
              <span>Live tips</span>
            </div>
          </div>
        </div>

        <div class="chat-body">
          <div class="chat-scroll">
            <div class="chat-messages" id="chatMessages"></div>
          </div>
        </div>

        <div class="chat-footer">
          <span>
            <span class="chat-footer-circle"></span>
            <span>Relaxing music enabled</span>
          </span>
          <span class="chat-footer-badge">
            <span>Tap cards to play</span>
          </span>
        </div>
      </section>
    </main>

    <!-- Start overlay -->
    <div class="start-overlay" id="startOverlay">
      <div class="start-card">
        <div class="start-card-header">
          <div class="start-title">
            <span>Mexican Loter√≠a</span>
            <span>Memory Game</span>
          </div>
          <div class="start-pill">
            <div class="start-pill-dot"></div>
            <span>Relaxing audio</span>
          </div>
        </div>

        <div class="start-body">
          <strong>Welcome.</strong> This enhanced memory game is inspired by
          <strong>Mexican Loter√≠a</strong>. Enjoy a minimalist dark interface with relaxing ambient music
          and smooth animations optimized for both desktop and mobile.
          <br /><br />
          Find pairs of cards with their <strong>Spanish names</strong> and elegant white symbols.
          I'll guide you with helpful messages as you play.
        </div>

        <div class="start-footer">
          <button class="btn-primary pulse" id="startButton">
            <span>Start game</span>
          </button>
          <div class="start-note">
            <div class="start-note-dot"></div>
            <span>
              Relaxing music and sound effects will start when you begin.
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    (() => {
      const TOTAL_PAIRS = 8;

      const loteriaCards = [
        {
          id: "el_gallo",
          name: "El Gallo",
          icon: "‚ú∏",
          caption: "The rooster that wakes your memory.",
          number: "01",
        },
        {
          id: "la_dama",
          name: "La Dama",
          icon: "‚óá",
          caption: "Elegance in every move.",
          number: "03",
        },
        {
          id: "el_catrin",
          name: "El Catr√≠n",
          icon: "‚ôú",
          caption: "A well-dressed mind never forgets.",
          number: "04",
        },
        {
          id: "el_corazon",
          name: "El Coraz√≥n",
          icon: "‚ô•",
          caption: "Play with a focused heart.",
          number: "27",
        },
        {
          id: "la_luna",
          name: "La Luna",
          icon: "‚òæ",
          caption: "Night remembers better than day.",
          number: "23",
        },
        {
          id: "el_sol",
          name: "El Sol",
          icon: "‚òÄ",
          caption: "Light up the hidden pairs.",
          number: "19",
        },
        {
          id: "la_estrella",
          name: "La Estrella",
          icon: "‚òÖ",
          caption: "A bright guide for each turn.",
          number: "29",
        },
        {
          id: "la_calavera",
          name: "La Calavera",
          icon: "‚ò†",
          caption: "Even memory has its mystery.",
          number: "42",
        },
      ];

      // DOM references
      const boardEl = document.getElementById("board");
      const movesCounterEl = document.getElementById("movesCounter");
      const pairsCounterEl = document.getElementById("pairsCounter");
      const timeCounterEl = document.getElementById("timeCounter");
      const chatMessagesEl = document.getElementById("chatMessages");
      const startOverlayEl = document.getElementById("startOverlay");
      const startButtonEl = document.getElementById("startButton");
      const resetButtonEl = document.getElementById("resetButton");
      const musicVolumeEl = document.getElementById("musicVolume");
      const sfxVolumeEl = document.getElementById("sfxVolume");

      // Game state
      let deck = [];
      let firstCard = null;
      let secondCard = null;
      let lockBoard = false;
      let moves = 0;
      let matchedPairs = 0;
      let timerInterval = null;
      let startTime = null;
      let hasStarted = false;

      // Audio (Web Audio API)
      let audioCtx = null;
      let bgGain = null;
      let sfxGain = null;
      let musicInterval = null;

      function initAudio() {
        if (audioCtx) return;
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        bgGain = audioCtx.createGain();
        sfxGain = audioCtx.createGain();
        bgGain.gain.value = musicVolumeEl.value / 100 * 0.15;
        sfxGain.gain.value = sfxVolumeEl.value / 100 * 0.25;
        bgGain.connect(audioCtx.destination);
        sfxGain.connect(audioCtx.destination);
        startAmbientMusic();
      }

      // Volume controls
      musicVolumeEl.addEventListener('input', (e) => {
        if (bgGain) {
          bgGain.gain.value = e.target.value / 100 * 0.15;
        }
      });

      sfxVolumeEl.addEventListener('input', (e) => {
        if (sfxGain) {
          sfxGain.gain.value = e.target.value / 100 * 0.25;
        }
      });

      function createTone(frequency, duration, gainNode, type = "sine") {
        if (!audioCtx || audioCtx.state === "suspended") return;

        const now = audioCtx.currentTime;
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = type;
        osc.frequency.setValueAtTime(frequency, now);

        gain.gain.setValueAtTime(0, now);
        gain.gain.linearRampToValueAtTime(1, now + 0.01);
        gain.gain.exponentialRampToValueAtTime(0.001, now + duration);

        osc.connect(gain);
        gain.connect(gainNode);

        osc.start(now);
        osc.stop(now + duration + 0.02);
      }

      function playFlipSound() {
        createTone(520, 0.15, sfxGain, "triangle");
      }

      function playMatchSound() {
        createTone(660, 0.22, sfxGain, "sine");
        setTimeout(() => createTone(880, 0.25, sfxGain, "sine"), 100);
      }

      function playMismatchSound() {
        createTone(280, 0.18, sfxGain, "square");
      }

      function playWinSound() {
        createTone(700, 0.22, sfxGain, "sine");
        setTimeout(() => createTone(880, 0.24, sfxGain, "sine"), 130);
        setTimeout(() => createTone(1047, 0.26, sfxGain, "sine"), 280);
      }

      // Enhanced relaxing ambient music
      function startAmbientMusic() {
        if (!audioCtx) return;
        if (musicInterval) {
          clearInterval(musicInterval);
          musicInterval = null;
        }

        // More relaxing chord progression (Cmaj7, Am7, Fmaj7, G7)
        const chords = [
          [261.63, 329.63, 392.00, 493.88], // Cmaj7
          [220.00, 261.63, 329.63, 415.30], // Am7
          [174.61, 220.00, 261.63, 329.63], // Fmaj7
          [196.00, 246.94, 293.66, 349.23], // G7
        ];

        let chordIndex = 0;

        musicInterval = setInterval(() => {
          if (!audioCtx) return;

          const chord = chords[chordIndex % chords.length];
          const now = audioCtx.currentTime;

          // Create ethereal pad-like sounds
          chord.forEach((freq, i) => {
            const osc1 = audioCtx.createOscillator();
            const gain1 = audioCtx.createGain();
            osc1.type = "sine";
            osc1.frequency.setValueAtTime(freq, now);

            const volume = 0.4 - (i * 0.08); // Decrease volume for higher notes
            gain1.gain.setValueAtTime(0, now);
            gain1.gain.linearRampToValueAtTime(volume, now + 0.4);
            gain1.gain.linearRampToValueAtTime(volume * 0.7, now + 1.8);
            gain1.gain.linearRampToValueAtTime(0.0, now + 3.2);

            osc1.connect(gain1);
            gain1.connect(bgGain);

            osc1.start(now);
            osc1.stop(now + 3.3);

            // Add subtle harmonics
            if (i % 2 === 0) {
              const osc2 = audioCtx.createOscillator();
              const gain2 = audioCtx.createGain();
              osc2.type = "triangle";
              osc2.frequency.setValueAtTime(freq * 2, now);

              gain2.gain.setValueAtTime(0, now);
              gain2.gain.linearRampToValueAtTime(0.15, now + 0.5);
              gain2.gain.linearRampToValueAtTime(0.0, now + 2.8);

              osc2.connect(gain2);
              gain2.connect(bgGain);

              osc2.start(now);
              osc2.stop(now + 2.9);
            }
          });

          chordIndex++;
        }, 3200); // Slower, more meditative pace
      }

      function stopAmbientMusic() {
        if (musicInterval) {
          clearInterval(musicInterval);
          musicInterval = null;
        }
      }

      // Chat helpers

      function appendChatMessage({ author = "assistant", text, meta }) {
        const row = document.createElement("div");
        row.className = "msg-row " + author;

        const avatar = document.createElement("div");
        avatar.className = "msg-avatar " + author;
        avatar.textContent = author === "assistant" ? "G" : "Y";

        const bubble = document.createElement("div");
        bubble.className = "msg-bubble " + author;
        bubble.textContent = text;

        const wrapper = document.createElement("div");
        wrapper.style.maxWidth = "100%";

        wrapper.appendChild(bubble);

        if (meta) {
          const metaEl = document.createElement("div");
          metaEl.className = "msg-meta";
          metaEl.textContent = meta;
          wrapper.appendChild(metaEl);
        }

        if (author === "assistant") {
          row.appendChild(avatar);
          row.appendChild(wrapper);
        } else {
          row.appendChild(wrapper);
          row.appendChild(avatar);
        }

        chatMessagesEl.appendChild(row);
        chatMessagesEl.parentElement.scrollTop =
          chatMessagesEl.parentElement.scrollHeight;
      }

      function showTypingIndicator() {
        const row = document.createElement("div");
        row.className = "msg-row assistant";
        row.id = "typing-indicator";

        const avatar = document.createElement("div");
        avatar.className = "msg-avatar assistant";
        avatar.textContent = "G";

        const bubble = document.createElement("div");
        bubble.className = "msg-bubble assistant";

        const typing = document.createElement("div");
        typing.className = "typing-indicator";
        for (let i = 0; i < 3; i++) {
          const dot = document.createElement("div");
          dot.className = "typing-dot";
          typing.appendChild(dot);
        }
        bubble.appendChild(typing);

        row.appendChild(avatar);
        row.appendChild(bubble);

        chatMessagesEl.appendChild(row);
        chatMessagesEl.parentElement.scrollTop =
          chatMessagesEl.parentElement.scrollHeight;
      }

      function hideTypingIndicator() {
        const indicator = document.getElementById("typing-indicator");
        if (indicator && indicator.parentElement) {
          indicator.parentElement.removeChild(indicator);
        }
      }

      function assistantSay(text, meta, delay = 350) {
        showTypingIndicator();
        setTimeout(() => {
          hideTypingIndicator();
          appendChatMessage({ author: "assistant", text, meta });
        }, delay);
      }

      // Game logic

      function shuffle(array) {
        const arr = array.slice();
        for (let i = arr.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [arr[i], arr[j]] = [arr[j], arr[i]];
        }
        return arr;
      }

      function buildDeck() {
        const base = loteriaCards.slice(0, TOTAL_PAIRS);
        const doubled = base.concat(
          base.map((card) => ({ ...card, clone: true }))
        );
        deck = shuffle(doubled);
      }

      function renderBoard() {
        boardEl.innerHTML = "";
        deck.forEach((card, index) => {
          const cardEl = document.createElement("div");
          cardEl.className = "card";
          cardEl.dataset.id = card.id;
          cardEl.dataset.index = index;

          const button = document.createElement("button");
          const inner = document.createElement("div");
          inner.className = "card-inner";

          const back = document.createElement("div");
          back.className = "card-face card-back";
          back.innerHTML = `
            <div class="card-back-top">GPT</div>
            <div class="card-back-center-min">
              <div class="card-back-symbol">‚ú¶</div>
            </div>
            <div class="card-back-label">Loter√≠a</div>
          `;

          const front = document.createElement("div");
          front.className = "card-face card-front";
          front.innerHTML = `
            <div class="card-header">
              <span class="card-number">${card.number}</span>
              <span>Loter√≠a</span>
            </div>
            <div class="card-main">
              <div class="card-icon">${card.icon}</div>
              <div class="card-name">${card.name}</div>
              <div class="card-caption">${card.caption}</div>
            </div>
            <div class="card-footer">
              <span class="card-tag">Memory</span>
              <span class="card-hint">Find twin</span>
            </div>
          `;

          inner.appendChild(back);
          inner.appendChild(front);
          button.appendChild(inner);
          cardEl.appendChild(button);
          boardEl.appendChild(cardEl);

          button.addEventListener("click", () => handleCardClick(cardEl, card));
        });
      }

      function formatTime(seconds) {
        const m = Math.floor(seconds / 60)
          .toString()
          .padStart(2, "0");
        const s = (seconds % 60).toString().padStart(2, "0");
        return `${m}:${s}`;
      }

      function startTimer() {
        if (timerInterval) clearInterval(timerInterval);
        startTime = Date.now();
        timerInterval = setInterval(() => {
          const elapsed = Math.floor((Date.now() - startTime) / 1000);
          timeCounterEl.textContent = formatTime(elapsed);
        }, 1000);
      }

      function stopTimer() {
        if (timerInterval) {
          clearInterval(timerInterval);
          timerInterval = null;
        }
      }

      function resetGame({ fromResetButton = false } = {}) {
        lockBoard = false;
        moves = 0;
        matchedPairs = 0;
        firstCard = null;
        secondCard = null;
        movesCounterEl.textContent = "0";
        pairsCounterEl.textContent = `0 / ${TOTAL_PAIRS}`;
        timeCounterEl.textContent = "00:00";
        stopTimer();

        buildDeck();
        renderBoard();

        if (hasStarted) {
          startTimer();
          if (fromResetButton) {
            assistantSay(
              "Fresh start! I've shuffled the deck. Take a deep breath and enjoy.",
              "Board reset"
            );
          }
        }
      }

      function handleCardClick(cardEl, cardData) {
        if (!hasStarted) return;
        if (lockBoard) return;
        if (cardEl.classList.contains("flipped")) return;

        cardEl.classList.add("flipped");
        playFlipSound();

        if (!firstCard) {
          firstCard = { el: cardEl, data: cardData };
          assistantSay(
            `You revealed ${cardData.name}. Remember its location.`,
            "First card"
          );
          return;
        }

        secondCard = { el: cardEl, data: cardData };
        moves++;
        movesCounterEl.textContent = moves.toString();
        lockBoard = true;

        if (firstCard.data.id === secondCard.data.id) {
          // Match
          matchedPairs++;
          pairsCounterEl.textContent = `${matchedPairs} / ${TOTAL_PAIRS}`;
          firstCard.el.classList.add("matched");
          secondCard.el.classList.add("matched");
          playMatchSound();

          assistantSay(
            `Perfect match: ${cardData.name}! Well done.`,
            `Pairs: ${matchedPairs} / ${TOTAL_PAIRS}`,
            300
          );

          resetTurn(false);

          if (matchedPairs === TOTAL_PAIRS) {
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            stopTimer();
            playWinSound();
            assistantSay(
              `Loter√≠a! You found all ${TOTAL_PAIRS} pairs in ${moves} moves and ${formatTime(
                elapsed
              )}. Excellent memory!`,
              "Victory!",
              600
            );
          }
        } else {
          // No match
          playMismatchSound();
          assistantSay(
            "Not a match. Take note of their positions and try again.",
            "No match",
            400
          );
          setTimeout(() => {
            firstCard.el.classList.remove("flipped");
            secondCard.el.classList.remove("flipped");
            resetTurn(true);
          }, 900);
        }
      }

      function resetTurn(unlock = true) {
        firstCard = null;
        secondCard = null;
        if (unlock) lockBoard = false;
        else setTimeout(() => (lockBoard = false), 50);
      }

      // Initial chat

      function initialChat() {
        appendChatMessage({
          author: "user",
          text: "I'd like to play a memory game with Mexican Loter√≠a cards.",
        });
        assistantSay(
          "Perfect! I've prepared an enhanced experience with relaxing music and smooth animations. Press 'Start game' when you're ready.",
          "Welcome!",
          600
        );
      }

      // Event bindings

      startButtonEl.addEventListener("click", () => {
        if (!audioCtx) {
          initAudio();
        } else if (audioCtx.state === "suspended") {
          audioCtx.resume();
        }

        hasStarted = true;
        resetGame({ fromResetButton: false });

        startOverlayEl.classList.add("fade-out");
        setTimeout(() => {
          startOverlayEl.classList.add("hidden");
        }, 380);

        assistantSay(
          "The game has started. Flip two cards at a time to find matching pairs. Relax and enjoy!",
          "Game in progress",
          800
        );
      });

      resetButtonEl.addEventListener("click", () => {
        if (!hasStarted) return;
        resetGame({ fromResetButton: true });
      });

      // Initialize
      initialChat();
      buildDeck();
      renderBoard();

      // For browsers that require an extra user gesture for audio
      document.body.addEventListener(
        "click",
        () => {
          if (audioCtx && audioCtx.state === "suspended") {
            audioCtx.resume();
          }
        },
        { once: true }
      );

      // Prevent pull-to-refresh on mobile
      document.body.addEventListener('touchmove', (e) => {
        if (e.target === document.body) {
          e.preventDefault();
        }
      }, { passive: false });

    })();
  </script>
</body>
</html>
